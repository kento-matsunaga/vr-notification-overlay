<Window x:Class="VRNotify.Desktop.Views.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:VRNotify.Desktop.ViewModels"
        Title="VRNotify Settings"
        Width="520" Height="480"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanMinimize">
    <Window.Resources>
        <Style TargetType="TabItem">
            <Setter Property="Padding" Value="12,6"/>
        </Style>
    </Window.Resources>

    <Grid Margin="8">
        <TabControl>

            <!-- General Tab -->
            <TabItem Header="General">
                <StackPanel Margin="16">
                    <TextBlock Text="DND Mode" FontWeight="SemiBold" Margin="0,0,0,8"/>
                    <RadioButton Content="Off (show all notifications)"
                                 IsChecked="{Binding CurrentDndMode, Converter={StaticResource EnumBoolConverter}, ConverterParameter=Off}"
                                 Margin="0,4"/>
                    <RadioButton Content="Suppress All"
                                 IsChecked="{Binding CurrentDndMode, Converter={StaticResource EnumBoolConverter}, ConverterParameter=SuppressAll}"
                                 Margin="0,4"/>
                    <RadioButton Content="High Priority Only"
                                 IsChecked="{Binding CurrentDndMode, Converter={StaticResource EnumBoolConverter}, ConverterParameter=HighPriorityOnly}"
                                 Margin="0,4"/>
                </StackPanel>
            </TabItem>

            <!-- Filter Tab -->
            <TabItem Header="Filter">
                <Grid Margin="16">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" Text="Filter Mode" FontWeight="SemiBold" Margin="0,0,0,8"/>
                    <StackPanel Grid.Row="1" Margin="0,0,0,12">
                        <RadioButton Content="Allow all (blocklist mode)"
                                     IsChecked="{Binding Filter.IsAllowlistMode, Converter={StaticResource InverseBoolConverter}}"
                                     Margin="0,2"/>
                        <RadioButton Content="Block all (allowlist mode)"
                                     IsChecked="{Binding Filter.IsAllowlistMode}"
                                     Margin="0,2"/>
                    </StackPanel>

                    <ListView Grid.Row="2" ItemsSource="{Binding Filter.Apps}" Margin="0,0,0,8">
                        <ListView.View>
                            <GridView>
                                <GridViewColumn Header="App Name" Width="200"
                                                DisplayMemberBinding="{Binding AppName}"/>
                                <GridViewColumn Header="Status" Width="120">
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <ToggleButton Content="{Binding IsAllowed, Converter={StaticResource AllowedTextConverter}}"
                                                          IsChecked="{Binding IsAllowed}"
                                                          Padding="8,2" MinWidth="70"/>
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </GridViewColumn>
                            </GridView>
                        </ListView.View>
                    </ListView>

                    <TextBlock Grid.Row="3" Text="* Apps are auto-detected when notifications arrive"
                               FontStyle="Italic" Foreground="Gray" FontSize="11"/>
                </Grid>
            </TabItem>

            <!-- Display Tab -->
            <TabItem Header="Display">
                <StackPanel Margin="16">
                    <TextBlock Text="Position" FontWeight="SemiBold" Margin="0,0,0,4"/>
                    <ComboBox ItemsSource="{Binding Display.AvailablePositions}"
                              SelectedItem="{Binding Display.Position}"
                              Margin="0,0,0,16" Width="200" HorizontalAlignment="Left"/>

                    <TextBlock Text="Display Duration" FontWeight="SemiBold" Margin="0,0,0,4"/>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                        <Slider Value="{Binding Display.DisplayDurationSeconds}"
                                Minimum="2" Maximum="15" Width="250"
                                TickFrequency="1" IsSnapToTickEnabled="True"/>
                        <TextBlock Text="{Binding Display.DisplayDurationSeconds, StringFormat='{}{0} sec'}"
                                   Margin="8,0,0,0" VerticalAlignment="Center"/>
                    </StackPanel>

                    <TextBlock Text="Opacity" FontWeight="SemiBold" Margin="0,0,0,4"/>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                        <Slider Value="{Binding Display.Opacity}"
                                Minimum="0.1" Maximum="1.0" Width="250"
                                TickFrequency="0.1" IsSnapToTickEnabled="True"/>
                        <TextBlock Text="{Binding Display.Opacity, StringFormat='{}{0:P0}'}"
                                   Margin="8,0,0,0" VerticalAlignment="Center"/>
                    </StackPanel>

                    <TextBlock Text="Scale" FontWeight="SemiBold" Margin="0,0,0,4"/>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                        <Slider Value="{Binding Display.Scale}"
                                Minimum="0.5" Maximum="2.0" Width="250"
                                TickFrequency="0.1" IsSnapToTickEnabled="True"/>
                        <TextBlock Text="{Binding Display.Scale, StringFormat='{}{0:P0}'}"
                                   Margin="8,0,0,0" VerticalAlignment="Center"/>
                    </StackPanel>
                </StackPanel>
            </TabItem>

            <!-- History Tab -->
            <TabItem Header="History">
                <Grid Margin="16">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <ListView Grid.Row="0" ItemsSource="{Binding History.Entries}" Margin="0,0,0,8">
                        <ListView.View>
                            <GridView>
                                <GridViewColumn Header="Time" Width="60"
                                                DisplayMemberBinding="{Binding TimeDisplay}"/>
                                <GridViewColumn Header="App" Width="80"
                                                DisplayMemberBinding="{Binding AppName}"/>
                                <GridViewColumn Header="Sender" Width="100"
                                                DisplayMemberBinding="{Binding Sender}"/>
                                <GridViewColumn Header="Message" Width="200"
                                                DisplayMemberBinding="{Binding Message}"/>
                            </GridView>
                        </ListView.View>
                    </ListView>

                    <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Right">
                        <TextBlock Text="{Binding History.RetentionDays, StringFormat='Retention: {0} days'}"
                                   VerticalAlignment="Center" Margin="0,0,16,0"/>
                        <Button Content="Clear History" Command="{Binding History.ClearHistoryCommand}"
                                Padding="12,4"/>
                    </StackPanel>
                </Grid>
            </TabItem>

            <!-- About Tab -->
            <TabItem Header="About">
                <StackPanel Margin="16" VerticalAlignment="Center" HorizontalAlignment="Center">
                    <TextBlock Text="VRNotify" FontSize="24" FontWeight="Bold"
                               HorizontalAlignment="Center" Margin="0,0,0,8"/>
                    <TextBlock Text="VR Notification Overlay" FontSize="14"
                               HorizontalAlignment="Center" Foreground="Gray" Margin="0,0,0,16"/>
                    <TextBlock Text="v1.0.0" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                    <TextBlock Text="Windows notifications in VR via SteamVR overlay."
                               HorizontalAlignment="Center" TextWrapping="Wrap"
                               TextAlignment="Center" Margin="0,0,0,16"/>
                </StackPanel>
            </TabItem>

        </TabControl>
    </Grid>
</Window>
